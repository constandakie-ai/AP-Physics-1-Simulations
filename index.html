<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AP Physics 1 Complete Simulation Suite</title>
    <style>
        /* --- CORE THEME --- */
        :root {
            --primary: #2c3e50;
            --accent: #2980b9;
            --text: #333;
            --bg: #f4f6f7;
            --panel-bg: #ffffff;
            --math-font: 'Times New Roman', serif;
        }
        body { font-family: 'Segoe UI', system-ui, sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        
        /* --- LAYOUT --- */
        #app-container { display: flex; height: 100%; }
        
        /* SIDEBAR NAVIGATION */
        aside { width: 260px; background: var(--primary); color: white; display: flex; flex-direction: column; overflow-y: auto; flex-shrink: 0; }
        aside h1 { padding: 20px; font-size: 1.2rem; margin: 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .unit-header { padding: 15px 20px; font-weight: bold; background: rgba(0,0,0,0.2); cursor: pointer; display: flex; justify-content: space-between; font-size: 0.9rem; }
        .unit-header:hover { background: rgba(0,0,0,0.3); }
        .sub-menu { display: none; background: #34495e; }
        .sub-menu.open { display: block; }
        .nav-btn { width: 100%; text-align: left; padding: 12px 30px; background: none; border: none; color: #bdc3c7; cursor: pointer; font-size: 0.85rem; transition: 0.2s; border-left: 3px solid transparent; }
        .nav-btn:hover { color: white; background: rgba(255,255,255,0.05); }
        .nav-btn.active { color: white; border-left-color: var(--accent); background: rgba(0,0,0,0.2); }

        /* MAIN CONTENT AREA */
        main { flex: 1; padding: 20px; overflow-y: auto; display: flex; flex-direction: column; gap: 20px; }
        
        /* SIMULATION CONTAINER */
        .sim-container { display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-start; }
        .canvas-area { position: relative; border-radius: 8px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.1); background: white; }
        canvas { display: block; cursor: crosshair; }
        
        /* CONTROLS PANEL */
        .controls { background: var(--panel-bg); padding: 20px; border-radius: 8px; width: 300px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); flex-shrink: 0; }
        .control-group { margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        label { display: flex; justify-content: space-between; font-size: 0.9rem; font-weight: 500; margin-bottom: 5px; color: #555; }
        input[type=range] { width: 100%; cursor: pointer; }
        
        /* DESCRIPTION BOX */
        .desc-box { background: white; padding: 20px; border-radius: 8px; border-left: 5px solid var(--accent); line-height: 1.6; color: #444; max-width: 900px; }
        .desc-box h3 { margin-top: 0; color: var(--primary); }

        /* MATH TYPOGRAPHY */
        .var { font-family: var(--math-font); font-style: italic; }
        .unit { font-family: sans-serif; font-style: normal; font-size: 0.85em; color: #7f8c8d; }

        /* UTILITY CLASSES */
        .hidden { display: none !important; }
        .btn { width: 100%; padding: 10px; border: none; border-radius: 4px; color: white; font-weight: bold; cursor: pointer; margin-top: 5px; }
        .btn-green { background: #27ae60; } .btn-green:hover { background: #219150; }
        .btn-red { background: #c0392b; } .btn-red:hover { background: #a93226; }
        
        /* DATA READOUT */
        .readout { font-family: monospace; background: #eee; padding: 10px; border-radius: 4px; margin-top: 10px; font-size: 0.85rem; }

        /* --- THEME VARIATIONS --- */
        /* Space Theme for Unit 3 */
        .theme-space .canvas-area { background: #000; border: 1px solid #333; }
        .theme-space .controls { background: #1a1a1a; color: #ddd; }
        .theme-space label { color: #bbb; }
        .theme-space .readout { background: #333; color: #0f0; }

        /* Lab Theme for Unit 2 */
        .theme-lab .canvas-area { background: #f0f3f5; border: 4px solid #bdc3c7; }
    </style>
</head>
<body>

<div id="app-container">
    <aside>
        <h1>AP Physics 1 Lab</h1>
        
        <div class="unit-header" onclick="toggleMenu('u1-menu')">Unit 1: Kinematics <span>▼</span></div>
        <div id="u1-menu" class="sub-menu open">
            <button class="nav-btn active" onclick="loadSim('1.1')">1.1 Position & Velocity</button>
            <button class="nav-btn" onclick="loadSim('1.2')">1.2 Acceleration (1D)</button>
            <button class="nav-btn" onclick="loadSim('1.3')">1.3 Projectile Motion</button>
        </div>

        <div class="unit-header" onclick="toggleMenu('u2-menu')">Unit 2: Dynamics <span>▼</span></div>
        <div id="u2-menu" class="sub-menu">
            <button class="nav-btn" onclick="loadSim('2.1')">2.1 Newton's 2nd Law</button>
            <button class="nav-btn" onclick="loadSim('2.2')">2.2 Inclined Planes</button>
            <button class="nav-btn" onclick="loadSim('2.3')">2.3 Connected Systems</button>
        </div>

        <div class="unit-header" onclick="toggleMenu('u3-menu')">Unit 3: Circ. Motion <span>▼</span></div>
        <div id="u3-menu" class="sub-menu">
            <button class="nav-btn" onclick="loadSim('3.1')">3.1 Uniform Circ. Motion</button>
            <button class="nav-btn" onclick="loadSim('3.2')">3.2 Gravitation & Orbits</button>
        </div>

        <div class="unit-header" style="opacity:0.5">Unit 4: Energy (Coming Soon)</div>
        <div class="unit-header" style="opacity:0.5">Unit 5: Momentum (Coming Soon)</div>
        <div class="unit-header" style="opacity:0.5">Unit 6: SHM (Coming Soon)</div>
        <div class="unit-header" style="opacity:0.5">Unit 7: Torque (Coming Soon)</div>
    </aside>

    <main id="main-view">
        <h2 id="sim-title" style="margin-top:0; color: var(--primary);">Welcome</h2>
        
        <div id="sim-desc" class="desc-box">
            Select a simulation from the menu to begin.
        </div>

        <div class="sim-container hidden" id="sim-interface">
            <div class="canvas-area">
                <canvas id="sim-canvas" width="700" height="450"></canvas>
            </div>
            
            <div id="sim-controls" class="controls"></div>
        </div>
    </main>
</div>

<script>
    // === GLOBAL ENGINE ===
    const canvas = document.getElementById('sim-canvas');
    const ctx = canvas.getContext('2d');
    let currentSim = null;
    let animId = null;
    
    // Sim State Object (Reset on every load)
    let state = {};

    function toggleMenu(id) {
        document.getElementById(id).classList.toggle('open');
    }

    function stopSim() {
        if(animId) cancelAnimationFrame(animId);
        animId = null;
    }

    // === SIMULATION LOADER ===
    function loadSim(id) {
        stopSim();
        currentSim = id;
        
        // UI Reset
        document.getElementById('sim-interface').classList.remove('hidden');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active'); // Highlight button
        document.getElementById('main-view').className = ''; // Reset themes

        // Logic Switch
        switch(id) {
            case '1.1': setup_1_1(); break;
            case '1.2': setup_1_2(); break;
            case '1.3': setup_1_3(); break;
            case '2.1': setup_2_1(); break;
            case '2.2': setup_2_2(); break;
            case '2.3': setup_2_3(); break;
            case '3.1': setup_3_1(); break;
            case '3.2': setup_3_2(); break;
        }
    }

    // ===============================================
    // === UNIT 1: KINEMATICS (Clean, Vector Focus) ===
    // ===============================================

    // --- 1.1 Position & Velocity ---
    function setup_1_1() {
        document.getElementById('sim-title').innerText = "1.1 Position and Constant Velocity";
        document.getElementById('sim-desc').innerHTML = `
            <h3>Understanding Displacement</h3>
            <p>This simulation visualizes the relationship between position (<span class="var">x</span>) and constant velocity (<span class="var">v</span>). 
            Observe how the velocity vector (red arrow) dictates the rate of change of the position vector (blue arrow).
            The motion is 1-Dimensional.</p>`;
        
        // Controls
        document.getElementById('sim-controls').innerHTML = `
            <div class="control-group">
                <label>Velocity (<i class="var">v</i>): <span id="val-v">5</span> m/s</label>
                <input type="range" id="in-v" min="-10" max="10" value="5" oninput="state.v=parseFloat(this.value); updateReadout()">
            </div>
            <div class="control-group">
                <label>Start Pos (<i class="var">x<sub>0</sub></i>): <span id="val-x">0</span> m</label>
                <input type="range" id="in-x" min="-50" max="50" value="0" oninput="state.x=parseFloat(this.value); updateReadout(); draw_1_1()">
            </div>
            <button class="btn btn-green" onclick="state.running=!state.running; loop_1_1()">Start / Stop</button>
            <div class="readout">Time: <span id="out-t">0.0</span>s <br> Pos: <span id="out-x">0.0</span>m</div>
        `;

        // Init State
        state = { x: 0, v: 5, t: 0, running: false };
        draw_1_1();
    }

    function loop_1_1() {
        if(!state.running || currentSim !== '1.1') return;
        state.t += 0.02;
        state.x += state.v * 0.02;
        updateReadout();
        draw_1_1();
        animId = requestAnimationFrame(loop_1_1);
    }

    function draw_1_1() {
        ctx.clearRect(0,0,700,450);
        // Grid
        drawGrid(50);
        // Axis
        ctx.beginPath(); ctx.moveTo(0, 225); ctx.lineTo(700, 225); ctx.stroke();
        
        // Object
        let px = 350 + (state.x * 5); // Scale 5px = 1m
        drawCar(px, 225, state.v);

        // Position Vector
        drawVector(350, 225, px - 350, 0, "blue", "x");
    }

    // --- 1.3 Projectile Motion ---
    function setup_1_3() {
        document.getElementById('sim-title').innerText = "1.3 Projectile Motion";
        document.getElementById('sim-desc').innerHTML = `
            <h3>Independence of Motion</h3>
            <p>Projectiles move in two dimensions simultaneously. The horizontal motion (<span class="var">x</span>) is constant velocity, while the vertical motion (<span class="var">y</span>) is affected by gravity (<span class="var">g</span>). 
            Use this tool to separate components and visualize the trajectory.</p>`;
        
        document.getElementById('sim-controls').innerHTML = `
             <div class="control-group">
                <label>Initial V (<i class="var">v<sub>i</sub></i>): <span id="val-vi">25</span> m/s</label>
                <input type="range" id="in-vi" min="10" max="40" value="25" oninput="state.vi=parseFloat(this.value); reset_1_3()">
            </div>
            <div class="control-group">
                <label>Angle (<i class="var">&theta;</i>): <span id="val-th">45</span>&deg;</label>
                <input type="range" id="in-th" min="0" max="90" value="45" oninput="state.th=parseFloat(this.value); reset_1_3()">
            </div>
            <button class="btn btn-green" onclick="state.running=true; loop_1_3()">Launch</button>
            <button class="btn btn-red" onclick="reset_1_3()">Reset</button>
            <div class="readout">Range: <span id="out-r">0.0</span>m <br> Height: <span id="out-h">0.0</span>m</div>
        `;
        reset_1_3();
    }

    function reset_1_3() {
        state = { 
            vi: parseFloat(document.getElementById('in-vi')?.value || 25), 
            th: parseFloat(document.getElementById('in-th')?.value || 45),
            t: 0, x: 0, y: 0, running: false, trail: [] 
        };
        // Update labels
        document.getElementById('val-vi').innerText = state.vi;
        document.getElementById('val-th').innerText = state.th;
        draw_1_3();
    }

    function loop_1_3() {
        if(!state.running || currentSim !== '1.3') return;
        let dt = 0.05;
        state.t += dt;
        let rad = state.th * Math.PI/180;
        
        // Physics
        state.x = (state.vi * Math.cos(rad)) * state.t;
        state.y = (state.vi * Math.sin(rad) * state.t) - (0.5 * 9.8 * state.t**2);
        
        state.trail.push({x: state.x, y: state.y});

        if(state.y < 0) { state.y = 0; state.running = false; }
        
        // Data
        document.getElementById('out-r').innerText = state.x.toFixed(1);
        document.getElementById('out-h').innerText = Math.max(0, state.y).toFixed(1);

        draw_1_3();
        if(state.running) animId = requestAnimationFrame(loop_1_3);
    }

    function draw_1_3() {
        ctx.clearRect(0,0,700,450);
        // Ground
        ctx.fillStyle = "#ecf0f1"; ctx.fillRect(0, 400, 700, 50);
        
        // Trajectory
        ctx.beginPath(); ctx.strokeStyle = "#95a5a6"; ctx.setLineDash([5,5]);
        state.trail.forEach((p,i) => {
            let sx = 20 + p.x * 5; let sy = 400 - p.y * 5;
            if(i==0) ctx.moveTo(sx, sy); else ctx.lineTo(sx, sy);
        });
        ctx.stroke(); ctx.setLineDash([]);

        // Ball
        let sx = 20 + state.x * 5;
        let sy = 400 - state.y * 5;
        ctx.fillStyle = "#e74c3c"; ctx.beginPath(); ctx.arc(sx, sy, 6, 0, Math.PI*2); ctx.fill();

        // Component Vectors
        if(state.running || state.y > 0) {
            let vx = state.vi * Math.cos(state.th * Math.PI/180);
            let vy = state.vi * Math.sin(state.th * Math.PI/180) - (9.8 * state.t);
            drawVector(sx, sy, vx*2, 0, "blue"); // Vx
            drawVector(sx, sy, 0, -vy*2, "green"); // Vy (Note: negative y is up in canvas logic for vectors usually, but here sy is canvas coord)
        }
    }

    // ===============================================
    // === UNIT 2: DYNAMICS (Lab Bench Theme) ===
    // ===============================================

    function setup_2_2() {
        document.getElementById('main-view').classList.add('theme-lab'); // CSS class
        document.getElementById('sim-title').innerText = "2.2 Inclined Planes";
        document.getElementById('sim-desc').innerHTML = `
            <h3>Forces on a Slope</h3>
            <p>On an incline, gravity (<span class="var">F<sub>g</sub></span>) is resolved into perpendicular and parallel components. 
            Friction (<span class="var">F<sub>f</sub></span>) opposes motion. Adjust the coefficient of friction (<span class="var">&mu;</span>) and angle (<span class="var">&theta;</span>) to see if the block slides.</p>`;

        document.getElementById('sim-controls').innerHTML = `
            <div class="control-group">
                <label>Mass (<i class="var">m</i>): <span id="val-m">2</span> kg</label>
                <input type="range" id="in-m" min="1" max="10" value="2" oninput="state.m=parseFloat(this.value); draw_2_2()">
            </div>
            <div class="control-group">
                <label>Angle (<i class="var">&theta;</i>): <span id="val-a">30</span>&deg;</label>
                <input type="range" id="in-a" min="0" max="60" value="30" oninput="state.angle=parseFloat(this.value); draw_2_2()">
            </div>
            <div class="control-group">
                <label>Friction (<i class="var">&mu;</i>): <span id="val-mu">0.3</span></label>
                <input type="range" id="in-mu" min="0" max="1.0" step="0.1" value="0.3" oninput="state.mu=parseFloat(this.value); draw_2_2()">
            </div>
            <button class="btn btn-green" onclick="state.running=!state.running; loop_2_2()">Slide</button>
            <div class="readout">Net Force: <span id="out-f">0.0</span> N</div>
        `;
        
        state = { m: 2, angle: 30, mu: 0.3, x: 0, v: 0, running: false };
        draw_2_2();
    }

    function loop_2_2() {
        if(!state.running || currentSim !== '2.2') return;
        
        let g = 9.8;
        let rad = state.angle * Math.PI/180;
        let Fgx = state.m * g * Math.sin(rad);
        let Fgy = state.m * g * Math.cos(rad); // Normal force = Fgy
        let Ff = state.mu * Fgy;
        
        let Fnet = Fgx - Ff;
        if(Fnet < 0) Fnet = 0; // Static friction prevents moving up

        let a = Fnet / state.m;
        state.v += a * 0.02;
        state.x += state.v * 0.02;

        document.getElementById('out-f').innerText = Fnet.toFixed(2);
        
        if(state.x > 8) state.running = false; // End of ramp
        
        draw_2_2();
        animId = requestAnimationFrame(loop_2_2);
    }

    function draw_2_2() {
        // Lab Bench background
        ctx.fillStyle = "#f0f3f5"; ctx.fillRect(0,0,700,450);
        
        let rad = state.angle * Math.PI/180;
        let cx = 100, cy = 400;
        
        // Ramp
        ctx.fillStyle = "#bdc3c7"; 
        ctx.beginPath(); ctx.moveTo(cx, cy); 
        ctx.lineTo(cx + 500*Math.cos(rad), cy - 500*Math.sin(rad)); 
        ctx.lineTo(cx + 500*Math.cos(rad), cy); 
        ctx.fill();

        // Block Rotation Logic
        ctx.save();
        ctx.translate(cx, cy);
        ctx.rotate(-rad);
        
        let bx = state.x * 50 + 50; // px
        ctx.fillStyle = "#e67e22"; ctx.fillRect(bx, -40, 40, 40);
        
        // FBD
        let cenX = bx + 20; let cenY = -20;
        // Normal (Up relative to slope)
        drawVector(cenX, cenY, 0, -60, "blue"); 
        // Friction (Left relative to slope)
        if(state.mu > 0) drawVector(cenX, cenY, -40, 0, "red");
        
        ctx.restore();
        
        // Gravity (Always down in world space)
        // Need to project block center to world space
        let wx = cx + (bx+20)*Math.cos(rad) - (-20)*Math.sin(rad); // Simple approx
        // Actually: rotated x is bx+20, y is -20.
        let worldX = cx + (bx+20) * Math.cos(rad) - (-20) * Math.sin(rad); // Rotation matrix
        let worldY = cy + (bx+20) * Math.sin(-rad) + (-20) * Math.cos(-rad); // Note the -rad for canvas y flip? No, standard rot.
        // Simplified visual anchor:
        let visX = cx + (state.x*50 + 70)*Math.cos(rad);
        let visY = cy - (state.x*50 + 70)*Math.sin(rad);
        drawVector(visX, visY, 0, 60, "green"); // Gravity straight down
    }

    // ===============================================
    // === UNIT 3: CIRCULAR MOTION (Space Theme) ===
    // ===============================================

    function setup_3_2() {
        document.getElementById('main-view').classList.add('theme-space');
        document.getElementById('sim-title').innerText = "3.2 Universal Gravitation & Orbits";
        document.getElementById('sim-desc').innerHTML = `
            <h3>Orbit Simulation</h3>
            <p>The gravitational force (<span class="var">F<sub>g</sub></span>) provides the centripetal force required to keep a satellite in orbit. 
            If velocity (<span class="var">v</span>) is too high, the satellite escapes. If too low, it crashes.
            <br><i>Equation:</i> <span class="var">F<sub>g</sub> = Gm<sub>1</sub>m<sub>2</sub> / r<sup>2</sup></span></p>`;

        document.getElementById('sim-controls').innerHTML = `
             <div class="control-group">
                <label>Orbital Velocity (<span class="var">v</span>)</label>
                <input type="range" id="in-ov" min="0" max="10" step="0.1" value="4.5" oninput="reset_3_2()">
            </div>
             <div class="control-group">
                <label>Distance (<span class="var">r</span>)</label>
                <input type="range" id="in-or" min="50" max="200" value="120" oninput="reset_3_2()">
            </div>
            <button class="btn btn-green" onclick="state.running=!state.running; loop_3_2()">Play / Pause</button>
            <button class="btn btn-red" onclick="reset_3_2()">Reset</button>
        `;
        reset_3_2();
    }

    function reset_3_2() {
        let r = parseFloat(document.getElementById('in-or').value);
        let v = parseFloat(document.getElementById('in-ov').value);
        state = { 
            sunM: 1000, 
            planetX: r, planetY: 0, 
            vx: 0, vy: v, 
            trail: [], running: false 
        };
        draw_3_2();
    }

    function loop_3_2() {
        if(!state.running || currentSim !== '3.2') return;

        // Euler Integration for Orbits (Simple)
        let r2 = state.planetX**2 + state.planetY**2;
        let r = Math.sqrt(r2);
        let F = 5000 / r2; // G*M simplified to 5000 for visual scaling
        
        let angle = Math.atan2(state.planetY, state.planetX);
        let ax = -F * Math.cos(angle);
        let ay = -F * Math.sin(angle);

        state.vx += ax;
        state.vy += ay;
        state.planetX += state.vx;
        state.planetY += state.vy;

        state.trail.push({x: state.planetX, y: state.planetY});
        if(state.trail.length > 200) state.trail.shift();

        // Crash check
        if(r < 20) state.running = false; 

        draw_3_2();
        animId = requestAnimationFrame(loop_3_2);
    }

    function draw_3_2() {
        ctx.fillStyle = "#000000"; ctx.fillRect(0,0,700,450);
        
        let cx = 350, cy = 225; // Center of canvas
        
        // Star
        ctx.fillStyle = "#f1c40f"; 
        ctx.beginPath(); ctx.arc(cx, cy, 20, 0, Math.PI*2); ctx.fill();
        // Glow
        ctx.strokeStyle = "rgba(241, 196, 15, 0.2)"; ctx.lineWidth=10; ctx.stroke(); ctx.lineWidth=1;

        // Trail
        ctx.strokeStyle = "#3498db"; ctx.beginPath();
        state.trail.forEach((p, i) => {
            if(i==0) ctx.moveTo(cx + p.x, cy + p.y);
            else ctx.lineTo(cx + p.x, cy + p.y);
        });
        ctx.stroke();

        // Planet
        let px = cx + state.planetX;
        let py = cy + state.planetY;
        ctx.fillStyle = "#fff"; ctx.beginPath(); ctx.arc(px, py, 5, 0, Math.PI*2); ctx.fill();

        // Force Vector (Gravity)
        let angle = Math.atan2(state.planetY, state.planetX);
        let Flen = 30; // Visual length
        drawVector(px, py, -Flen*Math.cos(angle), -Flen*Math.sin(angle), "red");
        
        // Velocity Vector
        drawVector(px, py, state.vx*5, state.vy*5, "green");
    }

    // === UTILITY HELPERS ===
    
    // Updates the text numbers in the UI
    function updateReadout() {
        if(document.getElementById('out-t')) document.getElementById('out-t').innerText = state.t.toFixed(2);
        if(document.getElementById('out-x')) document.getElementById('out-x').innerText = state.x.toFixed(2);
        if(document.getElementById('val-v')) document.getElementById('val-v').innerText = state.v;
        if(document.getElementById('val-x')) document.getElementById('val-x').innerText = state.x;
    }

    // Boilerplate for empty/missing sims
    function setup_1_2() { missing("1.2 Constant Acceleration (1D)"); }
    function setup_2_1() { missing("2.1 Newton's Second Law"); }
    function setup_2_3() { missing("2.3 Connected Systems (Atwood)"); }
    function setup_3_1() { missing("3.1 Uniform Circular Motion"); }

    function missing(title) {
        document.getElementById('sim-title').innerText = title;
        document.getElementById('sim-desc').innerHTML = "<p>This simulation is queued for generation in the next update.</p>";
        document.getElementById('sim-controls').innerHTML = "<p style='color:#777; font-style:italic;'>Controls loading...</p>";
        ctx.clearRect(0,0,700,450);
        ctx.fillStyle = "#f4f6f7"; ctx.fillRect(0,0,700,450);
        ctx.fillStyle = "#333"; ctx.font = "20px Arial"; ctx.fillText("Pending Construction...", 250, 225);
    }

    // Helper: Draw Arrow
    function drawVector(x, y, dx, dy, color) {
        let head = 10;
        let angle = Math.atan2(dy, dx);
        ctx.strokeStyle = color; ctx.fillStyle = color; ctx.lineWidth = 2;
        ctx.beginPath(); ctx.moveTo(x, y); ctx.lineTo(x + dx, y + dy); ctx.stroke();
        ctx.beginPath(); 
        ctx.moveTo(x+dx, y+dy);
        ctx.lineTo(x+dx - head*Math.cos(angle-Math.PI/6), y+dy - head*Math.sin(angle-Math.PI/6));
        ctx.lineTo(x+dx - head*Math.cos(angle+Math.PI/6), y+dy - head*Math.sin(angle+Math.PI/6));
        ctx.fill();
        ctx.lineWidth = 1;
    }

    function drawCar(x, y, v) {
        ctx.fillStyle = "#34495e";
        ctx.fillRect(x-15, y-10, 30, 20); // Body
        ctx.fillStyle = "black";
        ctx.beginPath(); ctx.arc(x-10, y+10, 4, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(x+10, y+10, 4, 0, Math.PI*2); ctx.fill();
        // Velocity Arrow
        drawVector(x, y-15, v*3, 0, "red");
    }

    function drawGrid(step) {
        ctx.strokeStyle = "#e0e0e0";
        ctx.beginPath();
        for(let x=0; x<700; x+=step) { ctx.moveTo(x,0); ctx.lineTo(x,450); }
        for(let y=0; y<450; y+=step) { ctx.moveTo(0,y); ctx.lineTo(700,y); }
        ctx.stroke();
    }

    // Load Default
    loadSim('1.1');
</script>

</body>
</html>
